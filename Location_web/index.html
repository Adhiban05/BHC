<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mobile GPS Location</title>
</head>
<body>
  <h1>Get Mobile GPS Location with City & State</h1>
  <button onclick="getLocation()">Get My Location</button>
  
  <p id="status">Click the button to get GPS location.</p>
  <p><strong>Latitude:</strong> <span id="lat"></span></p>
  <p><strong>Longitude:</strong> <span id="lon"></span></p>
  <p><strong>City:</strong> <span id="city"></span></p>
  <p><strong>State:</strong> <span id="state"></span></p>
  <p><strong>Country:</strong> <span id="country"></span></p>

  <script>
    function isMobileDevice() {
      return /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    }

    function getLocation() {
      const status = document.getElementById("status");
      status.textContent = "Requesting GPS location...";

      if ("geolocation" in navigator) {
        const highAccuracy = isMobileDevice(); // Only enable high accuracy for mobiles
        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;

            document.getElementById("lat").textContent = lat;
            document.getElementById("lon").textContent = lon;
            status.textContent = "Fetching address details...";

            try {
              const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
              const data = await res.json();

              const address = data.address || {};
              document.getElementById("city").textContent = address.city || address.town || address.village || "N/A";
              document.getElementById("state").textContent = address.state || "N/A";
              document.getElementById("country").textContent = address.country || "N/A";

              status.textContent = "Location fetched successfully.";
            } catch (err) {
              status.textContent = "Error fetching address details.";
            }
          },
          (error) => {
            status.textContent = "Error: " + error.message;
          },
          {
            enableHighAccuracy: highAccuracy, // GPS for mobiles
            timeout: 20000,
            maximumAge: 0
          }
        );
      } else {
        status.textContent = "Geolocation is not supported by your browser.";
      }
    }
  </script>
</body>
</html>
